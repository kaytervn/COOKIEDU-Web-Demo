<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Advanced Bootstrap Table</title>
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
	<style>
		.table-container {
			max-width: 800px;
			margin: 0 auto;
		}

		.search-input {
			margin-bottom: 10px;
		}
	</style>
</head>

<body>
	<div class="container">
		<div class="table-container">
			<div class="form-group">
				<label for="rowsPerPage">Rows per page:</label>
				<select class="form-control" id="rowsPerPage" onchange="updatePage()">
					<option value="3">3</option>
					<option value="10">10</option>
					<option value="20">20</option>
				</select>
			</div>
			<div class="input-group mb-3">
				<input type="text" class="form-control search-input" placeholder="Search..." oninput="executeSearch()">
				<div class="input-group-append">
					<button class="btn btn-outline-secondary" type="button" onclick="executeSearch()">Search</button>
				</div>
			</div>
			<table class="table table-bordered">
				<thead>
					<tr>
						<th onclick="sortTable(0)">ID</th>
						<th onclick="sortTable(1)">Name</th>
						<th onclick="sortTable(2)">Age</th>
					</tr>
				</thead>
				<tbody>
					<!-- Sample data -->
					<tr>
						<td>1</td>
						<td>John</td>
						<td>25</td>
					</tr>
					<tr>
						<td>2</td>
						<td>Doe</td>
						<td>30</td>
					</tr>
					<tr>
						<td>3</td>
						<td>Jane</td>
						<td>28</td>
					</tr>
					<tr>
						<td>4</td>
						<td>Alice</td>
						<td>35</td>
					</tr>
					<tr>
						<td>5</td>
						<td>Bob</td>
						<td>40</td>
					</tr>
					<tr>
						<td>6</td>
						<td>json</td>
						<td>32</td>
					</tr>
					<tr>
						<td>7</td>
						<td>Michael</td>
						<td>27</td>
					</tr>
					<tr>
						<td>8</td>
						<td>jaw</td>
						<td>33</td>
					</tr>
					<tr>
						<td>9</td>
						<td>jesus</td>
						<td>29</td>
					</tr>
					<tr>
						<td>10</td>
						<td>Lisa</td>
						<td>31</td>
					</tr>
					<tr>
						<td>11</td>
						<td>Kevin</td>
						<td>36</td>
					</tr>
					<tr>
						<td>12</td>
						<td>jeff</td>
						<td>26</td>
					</tr>
					<tr>
						<td>13</td>
						<td>dkmmj</td>
						<td>26</td>
					</tr>
				</tbody>
				<!-- More rows... -->
				</tbody>
			</table>
			<div class="text-center">
				<button class="btn btn-primary mr-2" onclick="exportToExcel()">Export to Excel</button>
				<button class="btn btn-secondary" onclick="previousPage()">Previous</button>
				<button class="btn btn-secondary" onclick="nextPage()">Next</button>
			</div>
			<div class="text-center" id="entriesInfo"></div>
		</div>
	</div>

	<script>
		let currentPage = 0;
		let pageSize = 3;
		let table = document.querySelector('table');
		let totalData = 0;
		updatePage();

		function sortTable(columnIndex) {
			let rows = Array.from(table.querySelectorAll('tr')).slice(1);
			let isAscending = true;

			rows.sort((a, b) => {
				let aValue = a.children[columnIndex].textContent;
				let bValue = b.children[columnIndex].textContent;

				if (columnIndex === 0 || columnIndex === 2) {
					aValue = parseInt(aValue);
					bValue = parseInt(bValue);
				}

				if (isAscending) {
					return aValue.localeCompare(bValue);
				} else {
					return bValue.localeCompare(aValue);
				}
			});

			rows.forEach(row => table.appendChild(row));
			isAscending = !isAscending;
		}

		function exportToExcel() {
			let rows = Array.from(table.querySelectorAll('tr')).slice(1);
			let data = rows.map(row => Array.from(row.children).map(cell => cell.textContent));
			let ws = XLSX.utils.aoa_to_sheet(data);
			let wb = XLSX.utils.book_new();
			XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
			XLSX.writeFile(wb, "data.xlsx");
		}

		function previousPage() {
			if (currentPage > 0) {
				currentPage--;
				updatePage();
			}
		}

		function nextPage() {
			let totalPages = Math.ceil(totalData / pageSize);
			if (currentPage + 1 != totalPages) {
				currentPage++;
				updatePage();
			}
		}

		function updatePage() {
			const rowsPerPage = parseInt(document.getElementById('rowsPerPage').value);
			const input = document.querySelector('.search-input').value.toUpperCase();
			const rows = Array.from(table.querySelectorAll('tr')).slice(1);
			const pageSize = rowsPerPage;

			let totalEntries = 0;
			let index = 0;

			rows.forEach(row => {
				const shouldShow = Array.from(row.children).some(cell => cell.textContent.toUpperCase().indexOf(input) > -1);
				const isInRange = index >= currentPage * pageSize && index < (currentPage + 1) * pageSize;

				row.style.display = shouldShow && isInRange ? 'table-row' : 'none';

				if (shouldShow) {
					totalEntries++;
					index++;
				}
			});

			totalData = totalEntries;
			updateEntriesInfo(totalEntries);
		}

		function executeSearch() {
			currentPage = 0
			updatePage();
		}

		function updateEntriesInfo(totalEntries) {
			let firstEntry = currentPage * pageSize + 1;
			let lastEntry = Math.min((currentPage + 1) * pageSize, totalEntries);
			document.getElementById('entriesInfo').innerHTML = `Showing ${firstEntry} to ${lastEntry} of ${totalEntries} entries`;
		}
	</script>
</body>

</html>